<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>US Midterm Election Seat Changes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://fonts.googleapis.com/css2?family=Poltawski+Nowy:ital,wght@0,400..700;1,400..700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link href="../css/normalize.css" rel="stylesheet" />
  <link href="../css/grid.css" rel="stylesheet" />
  <link href="../css/screen.css" rel="stylesheet" />
  <link href="../css/styles.css" rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <style>
    body { font-family:'Open Sans', Arial, sans-serif; }
    table { font-size: 0.85em; }
    .arrow-up::before { content: '\25B2 '; }
    .arrow-down::before { content: '\25BC '; }
    .content-wrapper { max-width: 900px; margin: 0 auto; }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="wrap" style="display:flex; justify-content:space-between; align-items:center;">
      <div class="masthead">
        <a href="../index.html" class="site-title" style="font-family: 'Poltawski Nowy', serif; font-size: clamp(24px,3vw,36px); text-decoration:none; color:#111;">Ari Winkleman</a>
      </div>
      <div class="contact-icons" style="display:flex; gap:14px; align-items:center;">
        <a href="https://www.linkedin.com/in/ari-winkleman/" target="_blank" rel="noopener" aria-label="LinkedIn">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
            <path d="M19 0h-14c-2.76 0-5 2.24-5 5v14c0 2.76 2.24 5 5 5h14c2.76 0 5-2.24 5-5v-14c0-2.76-2.24-5-5-5zm-11 19h-3v-10h3v10zm-1.5-11.27c-.97 0-1.75-.79-1.75-1.76 0-.97.78-1.76 1.75-1.76s1.75.79 1.75 1.76c0 .97-.78 1.76-1.75 1.76zm13.5 11.27h-3v-5.6c0-1.34-.03-3.07-1.87-3.07-1.87 0-2.16 1.46-2.16 2.97v5.7h-3v-10h2.88v1.36h.04c.4-.75 1.38-1.54 2.84-1.54 3.04 0 3.6 2 3.6 4.6v5.6z"/>
          </svg>
        </a>
        <a href="mailto:ariswinkleman@gmail.com" aria-label="Email">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 13.065l-11.99-7.065h23.98l-11.99 7.065zm0 2.935l-12-7.065v11.065h24v-11.065l-12 7.065z"/>
          </svg>
        </a>
      </div>
    </div>
  </header>
<br><br>
  <main id="content" class="content-wrapper">
    <header class="text-center mb-6">
      <h1 class="text-3xl font-bold mb-2" style="font-family:'Poltawski Nowy', serif;">US Midterm Election Seat Changes</h1>
      <p class="text-gray-600 text-sm">Gains and losses in House and Senate seats by party and year</p>
    </header>

    <div class="overflow-x-auto flex justify-center">
      <table class="border-collapse shadow bg-white rounded-xl overflow-hidden" style="min-width:700px;">
        <thead class="bg-gray-200 text-gray-800">
          <tr>
            <th class="p-2 text-left">Year</th>
            <th class="p-2 text-left">President</th>
            <th class="p-2 text-left">Party</th>
            <th class="p-2 text-left">House Change</th>
            <th class="p-2 text-left">Senate Change</th>
          </tr>
        </thead>
        <tbody id="table-body"></tbody>
      </table>
    </div>
  </main>

  <footer class="site-footer text-center py-6 text-sm text-gray-600">
    <p>&copy; <span id="year"></span> Ari Winkleman. All Rights Reserved.</p>
  </footer>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();

    const PARTY = {
      'Democratic': '#6a8cc3',
      'Jacksonian': '#6a8cc3',
      'Anti-Jackson': '#ff7f0e',
      'Republican': '#df6f5c',
      'Federalist': '#009444',
      'Democratic-Republican': '#92278f',
      'Whig': '#6f7b34',
      'National Republican': '#ff7f0e',
      'Pro-Administration': '#009444',
      'Anti-Administration': '#92278f',
      'Nullifier': '#72cbd7',
      'Anti-Masonic': '#f2e436',
      'Other': '#9aa0a6',
      'Populist': '#cc9dc8',
      'Progressive': '#a8d16e',
      'Dixiecrat': '#f4a261',
      'American Independent': '#e76f51'
    };

    function safeParse(val) {
      const num = parseFloat(val);
      return isNaN(num) ? 0 : num;
    }

    function heatColor(value, maxAbs) {
      if (value === 0) return 'rgba(200,200,200,0.4)'; // neutral gray
      const ratio = Math.abs(value) / maxAbs;
      return value > 0 ? `rgba(0,128,0,${0.2 + ratio * 0.6})` : `rgba(220,0,0,${0.2 + ratio * 0.6})`;
    }

    function formatPresidentImageName(name) {
      const normalized = name.replace(/\./g, '').replace(/\s+/g, ' ').trim();

      const exceptions = {
        'George HW Bush': 'George_HW_Bush.jpg',
        'John Quincy Adams': 'John_Quincy_Adams.jpg',
        'Martin Van Buren': 'Martin_Van_Buren.jpg',
        'William Howard Taft': 'William_Howard_Taft.jpg'
      };

      if (exceptions[normalized]) return exceptions[normalized];

      const parts = normalized.split(' ');
      if (parts.length === 2) return `${parts[0]}_${parts[1]}.jpg`;
      if (parts.length === 3) return `${parts[0]}_${parts[1].charAt(0)}_${parts[2]}.jpg`;
      if (parts.length > 3) return `${parts[0]}_${parts[1].charAt(0)}_${parts.slice(-1)[0]}.jpg`;
      return `${normalized.replace(/\s+/g, '_')}.jpg`;
    }

    function renderTable(data) {
      const tbody = document.getElementById('table-body');
      tbody.innerHTML = '';

      const maxHouse = Math.max(...data.map(d => Math.abs(safeParse(d['House seat changes']))));
      const maxSenate = Math.max(...data.map(d => Math.abs(safeParse(d['Senate seat changes']))));

      data.forEach(row => {
        const house = safeParse(row['House seat changes']);
        const senate = safeParse(row['Senate seat changes']);
        const totalHouse = safeParse(row['Total number of seats in the House']);
        const totalSenate = safeParse(row['Total number of seats in Senate']);

        const housePct = totalHouse ? ((house / totalHouse) * 100).toFixed(1) : '0.0';
        const senatePct = totalSenate ? ((senate / totalSenate) * 100).toFixed(1) : '0.0';

        const houseArrow = house > 0 ? 'arrow-up text-green-700' : house < 0 ? 'arrow-down text-red-700' : '';
        const senateArrow = senate > 0 ? 'arrow-up text-green-700' : senate < 0 ? 'arrow-down text-red-700' : '';

        const tr = document.createElement('tr');
        tr.className = 'border-b hover:bg-gray-100 transition';

        const partyColor = PARTY[row["President's party"]] || '#9aa0a6';

        tr.innerHTML = `
          <td class="p-2 font-semibold border-l-8" style="border-color:${partyColor}">${row['Year']}</td>
          <td class="p-2 flex items-center space-x-2">
            <img src="images/presidents/${formatPresidentImageName(row['Sitting president'])}" alt="${row['Sitting president']}" class="w-8 h-8 rounded-full object-cover border" />
            <span>${row['Sitting president']}</span>
          </td>
          <td class="p-2" style="color:${partyColor}">${row["President's party"]}</td>
          <td class="p-2 ${houseArrow}" style="background:${heatColor(house, maxHouse)}">${house > 0 ? '+' : house < 0 ? '' : ''}${house} (${housePct}%)</td>
          <td class="p-2 ${senateArrow}" style="background:${heatColor(senate, maxSenate)}">${senate > 0 ? '+' : senate < 0 ? '' : ''}${senate} (${senatePct}%)</td>
        `;
        tbody.appendChild(tr);
      });
    }

    Papa.parse('midterms.csv', {
      download: true,
      header: true,
      complete: function(results) {
        const cleanData = results.data.filter(row => row['Year'] && row['Sitting president']);
        renderTable(cleanData);
      }
    });
  </script>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-8FK0VXYYGX"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-8FK0VXYYGX');
  </script>
</body>
</html>
